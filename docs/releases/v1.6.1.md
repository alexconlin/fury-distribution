# Fury Distribution v1.6.1

Welcome to the **Fury Distribution v1.6.1**. This is a patch release to address an issue in some components of the Kubernetes Fury Distribution with Kubernetes 1.21 and above.

Until Kubernetes 1.20 Service Account Tokens did not expire, but starting from Kuebrnetes 1.21 they have expiration and are rotated automatically. Some components did not handle the token rotation gracefully.

Use this patch release only to fix clusters running KFD `1.6.0`, update to `1.7.x` or `1.23.x` if possible.

Please note that beacuse of upstream limitations this release **is not compatible with Kubernetes 1.20 and previous versions**.

Upgrading from KFD 1.6 to newer version should be at least to `1.7.2` and `1.23.2` otherwise you'll reintroduce the issue.

## Changelog

The most important changes are listed below:

- [networking](https://github.com/sighupio/fury-kubernetes-networking) ðŸ“¦ core module: v1.6.0 -> [**v1.9.0**](https://github.com/sighupio/fury-kubernetes-networking/releases/tag/v1.9.0)
  - Update [Calico] from version `3.19.1` to `3.23.2`.
- [logging](https://github.com/sighupio/fury-kubernetes-logging) ðŸ“¦ core module: v1.8.0 -> [**v1.10.3**](https://github.com/sighupio/fury-kubernetes-logging/releases/tag/v1.10.3)
  - Update [fluentd] from version `1.12.3` to `1.14.2`.
  - Update [fluent-bit] from version `1.7.7` to `1.9.5`.
  - Update [elasticsearch] from version `7.13.0` to `7.16.2`.
  - Update [kibana] from version `7.13.0` to `7.16.2`.

## Upgrade path

### Katalog Procedure

To upgrade this distribution from `1.6.0` to `v1.6.1`, you need to download this new version, vendor the dependencies,
finally applying the `kustomize` project.

```bash
furyctl vendor -H
kustomize build . | kubectl apply -f -
```

> **NOTE**: *The upgrade takes some minutes (depends on the cluster size), and you should expect some downtime during
the upgrade process.*
<!-- line left blank on purpose -->
> **NOTE**: *Run `kubectl apply` multiple times until you see no errors in the console*

[fluentd]: https://github.com/fluent/fluentd/releases/tag/v1.14.2
[curator]: https://github.com/elastic/curator/releases/tag/v5.8.4
[kibana]: https://github.com/elastic/kibana/releases/tag/v7.16.2
[elasticsearch]: https://github.com/elastic/elasticsearch/releases/tag/v7.16.2
[Cerebro]: https://github.com/lmenezes/cerebro/releases/tag/v0.9.4
[Velero]: https://velero.io/
[cert-manager]: https://github.com/jetstack/cert-manager
[forecastle]: https://github.com/stakater/Forecastle
[nginx]: https://github.com/kubernetes/ingress-nginx
[metrics-server]: https://github.com/kubernetes/kubernetes/tree/master/cluster/addons/metrics-server
[node-exporter]: https://github.com/prometheus/node_exporter
[kube-state-metrics]: https://github.com/kubernetes/kube-state-metrics
[Grafana]: https://grafana.com/
[Alertmanager]: https://github.com/prometheus/alertmanager
[Prometheus]: https://prometheus.io/
[Prometheus Operator]: https://github.com/prometheus-operator/prometheus-operator
[Calico]: https://www.projectcalico.org/
[Gatekeeper]: https://github.com/open-policy-agent/gatekeeper
[Gatekeeper Policy Manager]: https://github.com/sighupio/gatekeeper-policy-manager
[thanos]: https://github.com/thanos-io/thanos
[goldpinger]: https://github.com/bloomberg/goldpinger
[fluent-bit]: https://fluentbit.io/
[kube-proxy-metrics]: https://github.com/sighupio/fury-kubernetes-monitoring/tree/v1.12.0/katalog/kube-proxy-metrics
